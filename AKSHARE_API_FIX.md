# AKShare APIå…¼å®¹æ€§é—®é¢˜ä¿®å¤

## é—®é¢˜æè¿°

åœ¨ä½¿ç”¨AKShareè·å–è‚¡ç¥¨å†å²æ•°æ®æ—¶é‡åˆ°ä»¥ä¸‹é”™è¯¯ï¼š
```
stock_zh_a_hist å¤±è´¥: 'å‰å¤æƒ'
stock_zh_a_hist_min_em å¤±è´¥: 'NoneType' object is not subscriptable
```

## åŸå› åˆ†æ

1. **ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜**ï¼šä¸åŒç‰ˆæœ¬çš„AKShare APIå‚æ•°æ ¼å¼ä¸åŒ
2. **APIå˜åŒ–**ï¼šæŸäº›ç‰ˆæœ¬çš„AKShareå¯èƒ½ä¸æ”¯æŒ`adjust="å‰å¤æƒ"`è¿™æ ·çš„å‚æ•°
3. **å‚æ•°æ ¼å¼**ï¼šéœ€è¦æ ¹æ®AKShareç‰ˆæœ¬è°ƒæ•´å‚æ•°æ ¼å¼

## å·²å®æ–½çš„ä¿®å¤

### 1. æ”¹è¿›æ•°æ®è·å–é€»è¾‘
åœ¨ `src/data/akshare_data.py` ä¸­ï¼š
- æ·»åŠ äº†å¤šå±‚å›é€€æ–¹æ¡ˆ
- ä½¿ç”¨æœ€ç¨³å®šçš„APIè°ƒç”¨æ–¹å¼
- è‡ªåŠ¨é€‚é…ä¸åŒç‰ˆæœ¬çš„AKShare

### 2. åˆ›å»ºç®€åŒ–ç‰ˆæœ¬
æ–°å»ºäº† `src/data/akshare_data_simple.py`ï¼š
- ä½¿ç”¨æœ€ç®€å•ã€æœ€å…¼å®¹çš„æ–¹æ³•
- ä¸ä¾èµ–å¤æƒå‚æ•°
- åŒ…å«å®Œæ•´çš„é”™è¯¯å¤„ç†

### 3. å¤šæ–¹æ¡ˆå›é€€
ç°åœ¨çš„è·å–é€»è¾‘ï¼š
1. æ–¹æ³•1: `stock_zh_a_hist(symbol, period="daily", start_date, end_date, adjust="")`
2. æ–¹æ³•2: `stock_zh_a_hist(symbol, period="daily", start_date, end_date)` (æ— adjustå‚æ•°)
3. æ–¹æ³•3: `stock_zh_a_hist(symbol, period="daily")` (æ— æ—¥æœŸé™åˆ¶)
4. æ–¹æ³•4: ä½¿ç”¨ç®€åŒ–ç‰ˆæœ¬ `get_stock_history_simple()`

## æ¨èçš„AKShareç‰ˆæœ¬

**æ¨èç‰ˆæœ¬**ï¼š`akshare>=1.12.0`

```bash
# æ£€æŸ¥å½“å‰ç‰ˆæœ¬
pip show akshare

# æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
pip install --upgrade akshare

# æˆ–è€…å®‰è£…æ¨èç‰ˆæœ¬
pip install akshare==1.12.0
```

## æµ‹è¯•æ•°æ®è·å–

### æ–¹æ³•1ï¼šè¿è¡Œæµ‹è¯•è„šæœ¬
```bash
python test_stock.py
```

### æ–¹æ³•2ï¼šç›´æ¥æµ‹è¯•ç®€åŒ–ç‰ˆæœ¬
```bash
python -c "from src.data.akshare_data_simple import get_stock_history_simple; df = get_stock_history_simple('000001'); print(df)"
```

## ä½¿ç”¨å»ºè®®

### å¯¹äºçƒ­é—¨è‚¡ç¥¨ï¼ˆæ¨èï¼‰
ä½¿ç”¨ä»¥ä¸‹ä»£ç è¿›è¡Œæµ‹è¯•ï¼š
- **000001** - å¹³å®‰é“¶è¡Œ
- **000002** - ä¸‡ç§‘A  
- **600519** - è´µå·èŒ…å°
- **600000** - æµ¦å‘é“¶è¡Œ

è¿™äº›è‚¡ç¥¨æµåŠ¨æ€§å¥½ï¼Œæ•°æ®ç¨³å®šï¼ŒAPIæ”¯æŒå®Œå–„ã€‚

### å¯¹äºç‰¹æ®Šè‚¡ç¥¨
å¦‚æœé‡åˆ°ç‰¹å®šè‚¡ç¥¨æ— æ³•è·å–æ•°æ®ï¼š
1. æ£€æŸ¥è‚¡ç¥¨æ˜¯å¦é€€å¸‚
2. å°è¯•ä¸åŒçš„æ•°æ®æºï¼ˆAKShare/TuShareï¼‰
3. è¿è¡Œæµ‹è¯•è„šæœ¬æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
4. å‚è€ƒ `STOCK_DATA_GUIDE.md`

## æ›´æ–°ä»£ç 

å¦‚æœé‡åˆ°APIå…¼å®¹æ€§é—®é¢˜ï¼Œå¯ä»¥ï¼š

### æ–¹æ¡ˆ1ï¼šæ›´æ–°AKShare
```bash
venv\Scripts\pip.exe install --upgrade akshare
```

### æ–¹æ¡ˆ2ï¼šä½¿ç”¨ç‰¹å®šç‰ˆæœ¬
```bash
venv\Scripts\pip.exe install akshare==1.12.0
```

### æ–¹æ¡ˆ3ï¼šé™çº§åˆ°ç¨³å®šç‰ˆæœ¬
```bash
venv\Scripts\pip.exe install akshare==1.11.0
```

## éªŒè¯ä¿®å¤

è¿è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥AKShareç‰ˆæœ¬å’Œæ•°æ®è·å–ï¼š
```python
import akshare as ak
print(f"AKShareç‰ˆæœ¬: {ak.__version__}")

# æµ‹è¯•çƒ­é—¨è‚¡ç¥¨
df = ak.stock_zh_a_hist(symbol='000001', period='daily', 
                        start_date='20240101', end_date='20241201', adjust='')
print(f"æ•°æ®è¡Œæ•°: {len(df)}")
```

## æŠ€æœ¯ç»†èŠ‚

### è°ƒæ•´å‚æ•°çš„å˜åŒ–
- **æ—§ç‰ˆæœ¬**: `adjust="å‰å¤æƒ"` æˆ– `adjust="åå¤æƒ"`
- **æ–°ç‰ˆæœ¬**: `adjust=""` æˆ–ç›´æ¥ä¸ä¼ adjustå‚æ•°
- **æœ€ç¨³å®š**: ä½¿ç”¨`adjust=""`æˆ–å®Œå…¨ä¸æŒ‡å®šadjustå‚æ•°

### æ—¥æœŸæ ¼å¼
- è¾“å…¥æ ¼å¼ï¼š`'YYYY-MM-DD'` æˆ– `'YYYYMMDD'`
- ä»£ç ä¼šè‡ªåŠ¨è½¬æ¢
- APIéœ€è¦ï¼š`YYYYMMDD`æ ¼å¼

### æ•°æ®æ ‡å‡†åŒ–
- è‡ªåŠ¨æ£€æµ‹åˆ—åï¼ˆä¸­æ–‡/è‹±æ–‡ï¼‰
- è‡ªåŠ¨è½¬æ¢æ•°æ®ç±»å‹
- è‡ªåŠ¨æ’åºå’Œè¿‡æ»¤

## åç»­æ”¹è¿›è®¡åˆ’

1. âœ… æ·»åŠ å¤šå±‚å›é€€æœºåˆ¶
2. âœ… åˆ›å»ºç®€åŒ–ç‰ˆæœ¬å¤‡ç”¨æ–¹æ³•
3. âœ… æ”¹è¿›é”™è¯¯å¤„ç†å’Œæ—¥å¿—
4. ğŸ“‹ æ·»åŠ æ•°æ®ç¼“å­˜æœºåˆ¶ï¼ˆè§„åˆ’ä¸­ï¼‰
5. ğŸ“‹ æ”¯æŒæ›´å¤šæ•°æ®æºï¼ˆè§„åˆ’ä¸­ï¼‰

## é—®é¢˜åé¦ˆ

å¦‚æœä»ç„¶é‡åˆ°é—®é¢˜ï¼š
1. è¿è¡Œ `python test_stock.py` æŸ¥çœ‹è¯¦ç»†é”™è¯¯
2. æ£€æŸ¥AKShareç‰ˆæœ¬ï¼š`pip show akshare`
3. å°è¯•æ›´æ–°ï¼š`pip install --upgrade akshare`
4. æäº¤Issueæ—¶åŒ…å«ï¼š
   - AKShareç‰ˆæœ¬
   - Pythonç‰ˆæœ¬
   - å®Œæ•´é”™è¯¯ä¿¡æ¯

